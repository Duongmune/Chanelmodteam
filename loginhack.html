<!DOCTYPE html><html lang="vi"><head>    <meta charset="UTF-8">    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>ChanelMod Ultimate Security</title>    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">        <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>    <style>        /* --- 1. CORE STYLE --- */        * { box-sizing: border-box; outline: none; user-select: none; }        body {             margin: 0; padding: 20px 0;             background-color: #0f172a;             background-image: radial-gradient(at 50% 0%, #1e293b 0%, #0f172a 100%);            font-family: 'Inter', sans-serif;             min-height: 100vh;             display: flex; justify-content: center; align-items: center;             overflow-x: hidden;            overflow-y: auto;             color: #e2e8f0;         }        #particles { position: fixed; inset: 0; pointer-events: none; z-index: 0; }        .particle { position: absolute; background: rgba(78, 204, 163, 0.4); border-radius: 50%; animation: float linear infinite; }        @keyframes float { to { transform: translateY(-100px); opacity: 0; } }        /* --- 2. CARD --- */        .glass-card {            position: relative; z-index: 10; width: 440px; padding: 40px;            background: rgba(30, 41, 59, 0.75); backdrop-filter: blur(20px);            border: 1px solid rgba(255, 255, 255, 0.08); border-radius: 24px;            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);            transition: 0.3s;            margin: auto;         }        .header-section { text-align: center; margin-bottom: 25px; }        .icon-circle {            width: 64px; height: 64px; margin: 0 auto 15px;            background: rgba(78, 204, 163, 0.1); border-radius: 50%;            display: flex; align-items: center; justify-content: center;            border: 1px solid rgba(78, 204, 163, 0.2);            box-shadow: 0 0 20px rgba(78, 204, 163, 0.15);        }        .icon-circle svg { width: 32px; height: 32px; fill: #4ecca3; }                h2 { margin: 0 0 8px; font-size: 22px; color: white; letter-spacing: -0.5px; text-transform: uppercase; }        p.desc { font-size: 13px; color: #94a3b8; margin: 0; line-height: 1.5; }        /* --- 3. INPUTS --- */        .input-box { position: relative; margin-bottom: 16px; }        .input-box input {            width: 100%; background: #0f172a; border: 1px solid #334155;            padding: 15px 45px 15px 45px;             border-radius: 12px;            color: white; font-size: 14px; transition: 0.2s;        }        .input-box input:focus { border-color: #4ecca3; background: #151e32; box-shadow: 0 0 0 3px rgba(78, 204, 163, 0.15); }                .input-icon { position: absolute; left: 14px; top: 15px; width: 20px; height: 20px; fill: #64748b; transition: 0.2s; }        .input-box input:focus + .input-icon { fill: #4ecca3; }        .eye-icon {             position: absolute; right: 14px; top: 15px; width: 20px; height: 20px;             fill: #64748b; cursor: pointer; transition: 0.2s; z-index: 5;        }        .eye-icon:hover { fill: #e2e8f0; }        .eye-icon.active { fill: #4ecca3; }        .input-row { display: flex; gap: 10px; margin-bottom: 16px; }        .input-row .input-box { flex: 1; margin-bottom: 0; }                .btn-otp-separate {            width: 110px; background: rgba(78, 204, 163, 0.15); color: #4ecca3;            border: 1px solid rgba(78, 204, 163, 0.3); border-radius: 12px;            font-size: 13px; font-weight: 600; cursor: pointer; transition: 0.2s;        }        .btn-otp-separate:hover:not(:disabled) { background: #4ecca3; color: #0f172a; }        .btn-otp-separate:disabled { opacity: 0.5; cursor: not-allowed; }        .pass-strength { height: 4px; background: #334155; margin-top: -10px; margin-bottom: 16px; border-radius: 2px; overflow: hidden; display: flex; }        .strength-bar { height: 100%; width: 0%; transition: 0.3s; }        .strength-text { font-size: 11px; text-align: right; margin-top: -12px; margin-bottom: 10px; display: block; color: #64748b; }        .btn-main {            width: 100%; padding: 15px; background: #4ecca3; color: #0f172a;            border: none; border-radius: 12px; font-weight: 700; cursor: pointer;            font-size: 15px; margin-top: 5px; transition: 0.2s;        }        .btn-main:hover { background: #34d399; transform: translateY(-2px); box-shadow: 0 5px 15px rgba(78, 204, 163, 0.3); }        .btn-main:disabled { background: #334155; color: #64748b; cursor: not-allowed; transform: none; box-shadow: none; }        .links { margin-top: 24px; display: flex; justify-content: space-between; font-size: 13px; }        .link { color: #94a3b8; cursor: pointer; text-decoration: none; transition: 0.2s; }        .link:hover { color: #4ecca3; }        .hidden { display: none !important; }        /* --- 4. TOAST --- */        #toast-box { position: fixed; top: 24px; right: 24px; z-index: 1000; display: flex; flex-direction: column; gap: 15px; }        .toast {            min-width: 340px; padding: 18px; background: rgba(30, 41, 59, 0.95);             backdrop-filter: blur(10px); border-left: 5px solid;            border-radius: 12px; box-shadow: 0 15px 40px rgba(0,0,0,0.4);            display: flex; align-items: flex-start;             animation: slideIn 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);            transition: all 0.4s ease;        }        .toast.error { border-color: #ef4444; }         .toast.success { border-color: #4ecca3; }        .toast.info { border-color: #3b82f6; }                .toast-icon { margin-right: 15px; margin-top: 2px; }        .toast-content { flex: 1; }        .toast h4 { margin: 0 0 5px; font-size: 15px; font-weight: 700; color: #f8fafc; }        .toast p { margin: 0; font-size: 13px; color: #cbd5e1; line-height: 1.5; }                @keyframes slideIn { from{transform: translateX(120%); opacity: 0;} to{transform: translateX(0); opacity: 1;} }        /* --- 5. MODALS --- */        #modalSuccess, #modalOtpNotice {            position: fixed; top: 0; left: 0; width: 100%; height: 100%;            background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(10px);            z-index: 999; display: flex; justify-content: center; align-items: center;            opacity: 0; visibility: hidden; transition: 0.3s;        }        #modalSuccess.active, #modalOtpNotice.active { opacity: 1; visibility: visible; }                .success-box {            background: #1e293b; width: 380px; padding: 32px; border-radius: 24px;            border: 1px solid rgba(78, 204, 163, 0.3); text-align: center;             transform: scale(0.8); transition: 0.3s; box-shadow: 0 20px 60px rgba(0,0,0,0.6);        }        #modalSuccess.active .success-box, #modalOtpNotice.active .success-box { transform: scale(1); }                .info-row { display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #334155; font-size: 13px; }        .info-row span:first-child { color: #94a3b8; }        .info-row span:last-child { color: #f1f5f9; font-weight: 500; text-align: right; max-width: 60%; }        .info-row:last-of-type { border: none; margin-bottom: 20px; }        .shake { animation: shake 0.4s ease-in-out; border-color: #ef4444 !important; }        @keyframes shake { 0%, 100% {transform: translateX(0);} 25% {transform: translateX(-5px);} 75% {transform: translateX(5px);} }        /* --- PHẦN THÊM: CSKH STYLE GÓC TRÊN PHẢI (THU GỌN) --- */        .cskh-wrapper { position: fixed; top: 20px; right: 20px; z-index: 9999; display: flex; flex-direction: column; align-items: flex-end; gap: 10px; }        .cskh-menu {             display: flex; flex-direction: column; gap: 8px;             transform: translateY(-10px); opacity: 0; visibility: hidden; transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);        }        .cskh-menu.active { transform: translateY(0); opacity: 1; visibility: visible; }                .cskh-item {            background: rgba(30, 41, 59, 0.95); backdrop-filter: blur(15px);            border: 1px solid rgba(78, 204, 163, 0.2); padding: 8px 16px;            border-radius: 12px; display: flex; align-items: center; gap: 10px;            color: white; text-decoration: none; font-size: 11px; font-weight: 700;            box-shadow: 0 8px 20px rgba(0,0,0,0.4); transition: 0.3s;            white-space: nowrap; border-left: 3px solid #4ecca3;        }        .cskh-item:hover { background: #4ecca3; color: #0f172a; transform: translateX(-5px); }        .cskh-item svg { width: 18px; height: 18px; }        .cskh-trigger {            width: 54px; height: 54px; border-radius: 50%;            background: #4ecca3; border: 2px solid rgba(255,255,255,0.2); cursor: pointer;            display: flex; align-items: center; justify-content: center;            box-shadow: 0 5px 15px rgba(0,0,0,0.3);            transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1);            position: relative; overflow: hidden; padding: 0;        }                .cskh-trigger.active { border-color: #ef4444; transform: rotate(360deg); }    </style></head><body>    <div id="particles"></div>    <div id="toast-box"></div>    <div class="cskh-wrapper">        <button class="cskh-trigger" id="cskhBtn" onclick="toggleCSKHMenu()">            <svg width="30" height="30" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">                <path d="M12 2L3 7V12C3 17.41 6.84 21.09 12 22C17.16 21.09 21 17.41 21 12V7L12 2Z" fill="#0f172a" stroke="#ffffff" stroke-width="1.5"/>                <circle cx="12" cy="10" r="3" stroke="#4ecca3" stroke-width="1.5"/>                <path d="M7 16C7 14.3431 9.23858 13 12 13C14.7614 13 17 14.3431 17 16" stroke="#4ecca3" stroke-width="1.5" stroke-linecap="round"/>                <path d="M19 11V13M21 12H17" stroke="#ffffff" stroke-width="1" stroke-linecap="round"/>            </svg>        </button>        <div class="cskh-menu" id="cskhMenu">            <a href="https://zalo.me/0355468973" target="_blank" class="cskh-item">                <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="12" fill="#0084FF"/><path d="M12 6c-3.314 0-6 2.149-6 4.8c0 1.485.833 2.81 2.138 3.708l-.513 1.884c-.053.194.14.364.305.263l2.212-1.345c.6.126 1.228.19 1.858.19 3.314 0 6-2.149 6-4.8S15.314 6 12 6z" fill="white"/></svg>                ZALO HỖ TRỢ            </a>            <a href="https://www.facebook.com/xem.phim.sex.18.mup" target="_blank" class="cskh-item">                <svg viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z" fill="#1877F2"/></svg>                FACEBOOK            </a>            <a href="https://t.me/ADM_INVISIBLE" target="_blank" class="cskh-item">                <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="12" fill="#26A5E4"/><path d="M17.35 8.16l-2.52 11.88c-.19.84-.69 1.05-1.4.65l-3.85-2.83-1.85 1.79c-.2.2-.38.37-.78.37l.28-3.92 7.14-6.45c.31-.28-.07-.43-.48-.16l-8.83 5.55-3.8-.12c-.83-.26-.85-.83.17-1.23L16.29 4.93c.69-.26 1.3.15 1.06 1.23z" fill="white"/></svg>                TELEGRAM            </a>        </div>    </div>    <div id="modalOtpNotice">        <div class="success-box" style="border-color: #3b82f6;">            <div class="icon-circle" style="width: 80px; height: 80px; background: rgba(59, 130, 246, 0.2); border-color: rgba(59, 130, 246, 0.3);">                <svg viewBox="0 0 24 24" style="width: 40px; height: 40px; fill: #3b82f6;"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg>            </div>            <h3 style="color: #3b82f6; margin: 0 0 10px;">GỬI MÃ THÀNH CÔNG</h3>            <p style="font-size: 14px; color: #cbd5e1; line-height: 1.6; margin-bottom: 25px;">                Mã xác thực OTP đã được gửi đi!<br>                Vui lòng kiểm tra hộp thư và chờ từ <b>1-3 phút</b>.<br>                <span style="color: #4ecca3;">Tuyệt đối không thoát khỏi tiến trình này.</span>            </p>            <button class="btn-main" style="background: #3b82f6; color: white;" onclick="document.getElementById('modalOtpNotice').classList.remove('active')">ĐÓNG THÔNG BÁO</button>        </div>    </div>    <div id="modalSuccess">        <div class="success-box">            <div class="icon-circle" style="width: 80px; height: 80px; background: rgba(78, 204, 163, 0.2);">                <svg viewBox="0 0 24 24" style="width: 40px; height: 40px;"><path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"/></svg>            </div>            <h3 style="color: #4ecca3; margin: 0 0 8px;">KẾT NỐI THÀNH CÔNG</h3>            <p style="font-size: 13px; color: #94a3b8; margin-bottom: 24px;">Thiết bị của bạn đã được xác thực</p>                        <div class="info-row"><span>Thiết bị:</span> <span id="sucDevice">...</span></div>            <div class="info-row"><span>IP Address:</span> <span id="sucIP">...</span></div>            <div class="info-row"><span>Thời gian:</span> <span id="sucTime">...</span></div>            <div class="info-row"><span>User:</span> <span id="sucUser" style="color: #4ecca3;">...</span></div>                        <button class="btn-main" onclick="window.location.href='https://duongmune.github.io/Chanelmodteam/index.html'">TRUY CẬP WEBSITE</button>        </div>    </div>    <div class="glass-card" id="mainCard">                <div id="viewWelcome">            <div class="header-section">                <div class="icon-circle">                    <svg viewBox="0 0 24 24"><path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2zm-2 .5H6v-6c0-2.48 1.51-4.5 4-4.5s4 2.02 4 4.5v6z"/></svg>                </div>                <h2>THÔNG BÁO</h2>                <p class="desc">Chào mừng bạn đến với hệ thống.<br>Vui lòng <b>Đăng nhập</b> hoặc <b>Đăng ký</b> để tiếp tục.</p>            </div>            <button class="btn-main" id="btnStart">BẮT ĐẦU NGAY</button>        </div>        <div id="viewLogin" class="hidden">            <div class="header-section">                <div class="icon-circle">                    <svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>                </div>                <h2>Đăng Nhập</h2>                <p class="desc">Nhập thông tin tài khoản của bạn</p>            </div>            <div class="input-box">                <input type="text" id="logUser" placeholder="Tên tài khoản (@...)">                <svg class="input-icon" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08s5.97 1.09 6 3.08c-1.29 1.94-3.5 3.22-6 3.22z"/></svg>            </div>            <div class="input-box">                <input type="password" id="logPass" placeholder="Mật khẩu">                <svg class="input-icon" viewBox="0 0 24 24"><path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"/></svg>                <svg class="eye-icon" onclick="togglePass('logPass', this)" viewBox="0 0 24 24"><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>            </div>            <button class="btn-main" id="btnDoLogin">ĐĂNG NHẬP</button>            <div class="links">                <a class="link" id="toForgot">Quên mật khẩu?</a>                <a class="link" id="toReg" style="color: #4ecca3; font-weight: 600;">Tạo tài khoản mới</a>            </div>        </div>        <div id="viewReg" class="hidden">            <div class="header-section">                <div class="icon-circle">                    <svg viewBox="0 0 24 24"><path d="M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm-9-2V7H4v3H1v2h3v3h2v-3h3v-2H6zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>                </div>                <h2>Đăng Ký</h2>                <p class="desc">Tạo tài khoản thành viên mới</p>            </div>            <div class="input-box">                <input type="text" id="regUser" placeholder="Tên đăng nhập (VD: @abc12)">                <svg class="input-icon" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08s5.97 1.09 6 3.08c-1.29 1.94-3.5 3.22-6 3.22z"/></svg>            </div>                        <div class="input-box">                <input type="text" id="regName" placeholder="Tên hiển thị (Nickname)">                <svg class="input-icon" viewBox="0 0 24 24"><path d="M9 11.75c-.69 0-1.25.56-1.25 1.25s.56 1.25 1.25 1.25 1.25-.56 1.25-1.25-.56-1.25-1.25-1.25zm6 0c-.69 0-1.25.56-1.25 1.25s.56 1.25 1.25 1.25 1.25-.56 1.25-1.25-.56-1.25-1.25-1.25zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM4 12c0-4.41 3.59-8 8-8s8 3.59 8 8-3.59 8-8 8-8-3.59-8-8zm8 6c-2.33 0-4.31-1.46-5.11-3.5h10.22c-.8 2.04-2.78 3.5-5.11 3.5z"/></svg>            </div>            <div class="input-box" style="margin-bottom: 5px;">                <input type="password" id="regPass" placeholder="Mật khẩu bảo mật">                <svg class="input-icon" viewBox="0 0 24 24"><path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"/></svg>                <svg class="eye-icon" onclick="toggleRegSync(this)" viewBox="0 0 24 24"><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>            </div>            <div class="pass-strength"><div id="pBar" class="strength-bar"></div></div>            <span id="pText" class="strength-text">Độ mạnh: Chưa nhập</span>            <div class="input-box">                <input type="password" id="regPassConfirm" placeholder="Nhập lại mật khẩu">                <svg class="input-icon" viewBox="0 0 24 24"><path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"/></svg>            </div>            <div class="input-row">                <div class="input-box">                    <input type="email" id="regEmail" placeholder="Email nhận OTP">                    <svg class="input-icon" viewBox="0 0 24 24"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg>                </div>                <button class="btn-otp-separate" id="btnSendOtp">LẤY MÃ</button>            </div>            <div class="input-box">                <input type="text" id="regOtp" placeholder="Nhập mã OTP (6 số)">                <svg class="input-icon" viewBox="0 0 24 24"><path d="M18 2h-8L4.02 8 4 20c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-6 6h-2V4h2v4zm3 0h-2V4h2v4z"/></svg>            </div>            <button class="btn-main" id="btnDoReg">HOÀN TẤT ĐĂNG KÝ</button>            <div class="links" style="justify-content: center;"><a class="link" id="toLoginFromReg">Quay lại Đăng nhập</a></div>        </div>        <div id="viewForgot" class="hidden">            <div class="header-section">                <div class="icon-circle">                    <svg viewBox="0 0 24 24"><path d="M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"/></svg>                </div>                <h2>Khôi Phục</h2>                <p class="desc">Lấy lại mật khẩu qua Email</p>            </div>                        <div class="input-box">                <input type="text" id="forUser" placeholder="Tên tài khoản cũ">                <svg class="input-icon" viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>            </div>                        <div class="input-row">                <div class="input-box">                    <input type="email" id="forEmail" placeholder="Email đã đăng ký">                    <svg class="input-icon" viewBox="0 0 24 24"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg>                </div>                <button class="btn-otp-separate" id="btnSendOtpFor">LẤY MÃ</button>            </div>            <div class="input-box">                <input type="text" id="forOtp" placeholder="Mã OTP">                <svg class="input-icon" viewBox="0 0 24 24"><path d="M18 2h-8L4.02 8 4 20c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-6 6h-2V4h2v4zm3 0h-2V4h2v4z"/></svg>            </div>            <div class="input-box hidden" id="boxNewPass">                <input type="password" id="forNewPass" placeholder="Mật khẩu mới">                <svg class="input-icon" viewBox="0 0 24 24"><path d="M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm6-9h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6-5c1.66 0 3 1.34 3 3v2H9V6c0-1.66 1.34-3 3-3z"/></svg>                <svg class="eye-icon" onclick="togglePass('forNewPass', this)" viewBox="0 0 24 24"><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>            </div>            <button class="btn-main" id="btnDoForgot">ĐỔI MẬT KHẨU</button>            <div class="links" style="justify-content: center;"><a class="link" id="toLoginFromFor">Quay lại</a></div>        </div>    </div>    <script>        // FIREBASE CONFIG MỚI NHẤT        const firebaseConfig = {          apiKey: "AIzaSyCe-m7enck71rO58WUkXlcZnfuYad8obEI",          authDomain: "sever-check-d7ad5.firebaseapp.com",          databaseURL: "https://sever-check-d7ad5-default-rtdb.firebaseio.com",          projectId: "sever-check-d7ad5",          storageBucket: "sever-check-d7ad5.firebasestorage.app",          messagingSenderId: "307171449559",          appId: "1:307171449559:web:093bf6026c8c9ffd7b2e92",          measurementId: "G-9THVH2DXF4"        };        try { firebase.initializeApp(firebaseConfig); } catch(e){}        // LOGIC CSKH CẬP NHẬT: Xoay tròn mượt mà và thu gọn        function toggleCSKHMenu() {            const btn = document.getElementById('cskhBtn');            const menu = document.getElementById('cskhMenu');            btn.classList.toggle('active');            menu.classList.toggle('active');        }        // 1. Hàm bật tắt pass thường        window.togglePass = function(id, icon) {            const input = document.getElementById(id);            if(input.type === "password") {                input.type = "text";                icon.classList.add("active");                icon.innerHTML = '<path d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"/>';            } else {                input.type = "password";                icon.classList.remove("active");                icon.innerHTML = '<path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>';            }        };        // 2. Hàm bật tắt pass ĐỒNG BỘ (Register)        window.toggleRegSync = function(icon) {            const pass = document.getElementById('regPass');            const confirm = document.getElementById('regPassConfirm');            if(pass.type === "password") {                pass.type = "text";                confirm.type = "text";                icon.classList.add("active");                icon.innerHTML = '<path d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"/>';            } else {                pass.type = "password";                confirm.type = "password";                icon.classList.remove("active");                icon.innerHTML = '<path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>';            }        };        (function() {            emailjs.init("Drt3X1B9YomWPPf9z");            let _secureOtp = { code: null, expire: null };            let _passScore = 0;             let _activeToasts = [];             // Particles            for(let i=0; i<30; i++){                let p = document.createElement('div');                p.className = 'particle';                p.style.left = Math.random()*100+'vw'; p.style.top = Math.random()*100+'vh';                p.style.width = Math.random()*4+'px'; p.style.height=p.style.width;                p.style.animationDuration = Math.random()*10+5+'s';                document.getElementById('particles').appendChild(p);            }            async function hashPass(str) {                const msgBuffer = new TextEncoder().encode(str);                const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);                const hashArray = Array.from(new Uint8Array(hashBuffer));                return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');            }            function getDeviceName() {                const ua = navigator.userAgent;                let device = "Thiết bị lạ";                const match = ua.match(/\(([^)]+)\)/);                if(match && match[1]) {                    const parts = match[1].split(';');                    for(let part of parts) {                        part = part.trim();                        if(part.includes("Android") || part.includes("Linux") || part.includes("CPU") || part.includes("Locale")) continue;                        if(part.length > 2) { device = part; break; }                    }                }                if(device === "Thiết bị lạ") {                    if (/android/i.test(ua)) return "Android Generic";                    if (/iPad|iPhone|iPod/.test(ua)) return "Apple Device";                    if (/windows/i.test(ua)) return "Windows PC";                }                return device;            }            const showToast = (type, title, msg) => {                if(_activeToasts.includes(msg)) return;                _activeToasts.push(msg);                const b = document.getElementById('toast-box');                const t = document.createElement('div');                t.className = `toast ${type}`;                                let icon = '';                if(type === 'error') icon = `<svg viewBox="0 0 24 24" width="22" height="22" fill="#ef4444"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>`;                else if(type === 'success') icon = `<svg viewBox="0 0 24 24" width="22" height="22" fill="#4ecca3"><path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"/></svg>`;                else if(type === 'info') icon = `<svg viewBox="0 0 24 24" width="22" height="22" fill="#3b82f6"><path d="M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/></svg>`;                t.innerHTML = `<div class="toast-icon">${icon}</div><div class="toast-content"><h4>${title}</h4><p>${msg}</p></div>`;                b.appendChild(t);                                setTimeout(() => {                     t.style.opacity='0';                     t.style.transform='translateX(120%)';                    setTimeout(()=> {                        t.remove();                        _activeToasts = _activeToasts.filter(item => item !== msg);                    }, 400);                 }, 5000);            }            async function showSuccessModal(user) {                // --- FIX: LƯU TRẠNG THÁI ĐĂNG NHẬP ĐỂ KHÔNG BỊ LOAD LẠI ---                localStorage.setItem("IS_LOGIN", "true");                                document.getElementById('mainCard').classList.add('hidden');                document.getElementById('modalSuccess').classList.add('active');                                document.getElementById('sucUser').innerText = user;                document.getElementById('sucDevice').innerText = getDeviceName();                document.getElementById('sucTime').innerText = new Date().toLocaleString('vi-VN');                try {                    const r = await fetch('https://api.ipify.org?format=json');                    const d = await r.json();                    document.getElementById('sucIP').innerText = d.ip;                } catch { document.getElementById('sucIP').innerText = "Ẩn danh"; }            }            const switchView = (id) => {                ['viewWelcome', 'viewLogin','viewReg','viewForgot'].forEach(i => document.getElementById(i).classList.add('hidden'));                document.getElementById(id).classList.remove('hidden');                document.querySelectorAll('input').forEach(i=>i.classList.remove('shake'));            }            document.getElementById('btnStart').onclick = () => switchView('viewLogin');            document.getElementById('toReg').onclick = () => switchView('viewReg');            document.getElementById('toForgot').onclick = () => switchView('viewForgot');            document.getElementById('toLoginFromReg').onclick = () => switchView('viewLogin');            document.getElementById('toLoginFromFor').onclick = () => switchView('viewLogin');            // --- PASSWORD STRENGTH ---            document.getElementById('regPass').addEventListener('input', function() {                const val = this.value;                const bar = document.getElementById('pBar');                const txt = document.getElementById('pText');                let score = 0;                if(val.length > 5) score++;                if(val.length > 8) score++;                if(/[A-Z]/.test(val)) score++;                if(/[0-9]/.test(val)) score++;                if(/[^A-Za-z0-9]/.test(val)) score++;                _passScore = score;                 if(val.length === 0) {                    bar.style.width = '0%'; bar.style.backgroundColor = '#334155';                    txt.innerText = 'Độ mạnh: Chưa nhập'; txt.style.color = '#64748b';                } else if(score < 3) {                    bar.style.width = '30%'; bar.style.backgroundColor = '#ef4444';                    txt.innerText = 'Độ mạnh: Yếu (Cần thêm số/kí tự)'; txt.style.color = '#ef4444';                } else if(score < 4) {                    bar.style.width = '60%'; bar.style.backgroundColor = '#f59e0b';                    txt.innerText = 'Độ mạnh: Trung bình'; txt.style.color = '#f59e0b';                } else {                    bar.style.width = '100%'; bar.style.backgroundColor = '#4ecca3';                    txt.innerText = 'Độ mạnh: Rất mạnh'; txt.style.color = '#4ecca3';                }            });            // --- SPAM & IP ---            const checkLocalSpam = (id) => {                const last = localStorage.getItem('otp_'+id);                if(last && Date.now() - last < 60000) {                    const btn = document.getElementById(id); btn.disabled = true;                    let s = Math.ceil((60000 - (Date.now() - last))/1000);                    btn.innerText = s+'s';                    let t = setInterval(()=>{ btn.innerText = (--s)+'s'; if(s<=0){ clearInterval(t); btn.disabled=false; btn.innerText="LẤY MÃ"; } },1000);                    return false;                }                return true;            }            checkLocalSpam('btnSendOtp'); checkLocalSpam('btnSendOtpFor');            async function checkIp() {                try {                    const r = await fetch('https://api.ipify.org?format=json');                    const d = await r.json();                    const ip = d.ip.replace(/\./g, '-');                    const today = new Date().toLocaleDateString("vi");                    const snap = await firebase.database().ref('ip_tracker/'+ip).get();                    if(snap.exists()){                        const v = snap.val();                        if(v.date === today && v.count >= 3) return {ok:false};                        return {ok:true, ip, count: (v.date===today?v.count:0), date: today};                    }                    return {ok:true, ip, count:0, date: today};                } catch { return {ok:true}; }            }            // --- HANDLE OTP ---            const handleSendOtp = async (emailId, userId, btn, type) => {                const email = document.getElementById(emailId).value.trim();                const user = userId ? document.getElementById(userId).value.trim() : null;                if(!email.includes('@')) {                    showToast('error', 'Lỗi Email', 'Vui lòng nhập Email hợp lệ!');                    return document.getElementById(emailId).parentElement.classList.add('shake');                }                if(type === 'reg') {                    if(!user || !user.startsWith('@') || user.length < 5) {                         showToast('error', 'Lỗi User', 'Vui lòng nhập Tên tài khoản đúng quy định trước!');                         return document.getElementById(userId).parentElement.classList.add('shake');                    }                    const regex = /^@[a-z0-9]+$/;                    if(!regex.test(user)) {                         showToast('error', 'Lỗi User', 'Tên tài khoản chỉ chứa chữ thường và số!');                         return document.getElementById(userId).parentElement.classList.add('shake');                    }                }                if(!checkLocalSpam(btn.id)) return showToast('error', 'Spam detected', 'Vui lòng chờ đếm ngược!');                btn.innerText = "..."; btn.disabled = true;                try {                    const dbRef = firebase.database().ref('users');                                        if(type === 'reg') {                        const snapUser = await dbRef.child(user).get();                        if(snapUser.exists()) {                            btn.disabled = false; btn.innerText = "LẤY MÃ";                            return showToast('error', 'Tồn tại', 'Tên tài khoản này đã có người dùng!');                        }                        const snapAll = await dbRef.orderByChild('email').equalTo(email).get();                        if(snapAll.exists()) {                            btn.disabled = false; btn.innerText = "LẤY MÃ";                            return showToast('error', 'Tồn tại', 'Email này đã được đăng ký!');                        }                    }                     else if (type === 'for') {                        const snapUser = await dbRef.child(document.getElementById('forUser').value.trim()).get();                        if(!snapUser.exists()) {                             btn.disabled = false; btn.innerText = "LẤY MÃ";                             return showToast('error', 'Lỗi', 'Tài khoản không tồn tại!');                        }                        if(snapUser.val().email !== email) {                             btn.disabled = false; btn.innerText = "LẤY MÃ";                             return showToast('error', 'Lỗi', 'Email không khớp với tài khoản!');                        }                    }                    const ipInfo = await checkIp();                    if(!ipInfo.ok) {                        btn.innerText = "LẤY MÃ"; btn.disabled = false;                        return showToast('error', 'Chặn IP', 'Bạn đã hết lượt gửi OTP hôm nay!');                    }                    const code = Math.floor(100000 + Math.random()*900000).toString();                    _secureOtp.code = code; _secureOtp.expire = Date.now() + 300000;                    await emailjs.send("service_yfa0fr9", "template_uzx883n", { to_email: email, otp_code: code });                                        // THÊM: Hiện bảng thông báo OTP thành công                    document.getElementById('modalOtpNotice').classList.add('active');                    showToast('success', 'Đã Gửi', 'Kiểm tra Email để lấy mã!');                    localStorage.setItem('otp_'+btn.id, Date.now());                    if(ipInfo.ip) firebase.database().ref('ip_tracker/'+ipInfo.ip).set({ count: ipInfo.count+1, date: ipInfo.date });                                        let s = 60;                    let t = setInterval(()=>{ btn.innerText = s-- + 's'; if(s<0){ clearInterval(t); btn.disabled=false; btn.innerText="LẤY MÃ"; } },1000);                } catch (err) {                    console.error(err);                    showToast('error', 'Lỗi Hệ thống', 'Kiểm tra mạng hoặc Firebase Rules');                    btn.disabled = false; btn.innerText = "LẤY MÃ";                }            }            document.getElementById('btnSendOtp').onclick = function(){ handleSendOtp('regEmail', 'regUser', this, 'reg'); };            document.getElementById('btnSendOtpFor').onclick = function(){ handleSendOtp('forEmail', null, this, 'for'); };            // --- REGISTER ---            document.getElementById('btnDoReg').onclick = async function() {                const u = document.getElementById('regUser').value.trim();                const p = document.getElementById('regPass').value;                const pc = document.getElementById('regPassConfirm').value;                const n = document.getElementById('regName').value;                const e = document.getElementById('regEmail').value;                const o = document.getElementById('regOtp').value;                if(!u || u.length < 5 || !u.startsWith('@')) {                    document.getElementById('regUser').parentElement.classList.add('shake');                    return showToast('error', 'Lỗi User', 'Tài khoản phải >5 ký tự và bắt đầu bằng @');                }                const regex = /^@[a-z0-9]+$/;                if(!regex.test(u)) {                     document.getElementById('regUser').parentElement.classList.add('shake');                     return showToast('error', 'Lỗi User', 'Chỉ dùng chữ thường và số (vd: @abc12)');                }                if(_passScore < 3) {                     document.getElementById('regPass').parentElement.classList.add('shake');                     return showToast('error', 'Mật khẩu Yếu', 'Vui lòng chọn mật khẩu mạnh hơn (Thêm số/kí tự)');                }                if(p !== pc) {                    document.getElementById('regPassConfirm').parentElement.classList.add('shake');                    return showToast('error', 'Lỗi Mật khẩu', 'Mật khẩu xác nhận không khớp!');                }                if(!n || !e || !o) return showToast('error', 'Thiếu thông tin', 'Vui lòng điền đủ các mục!');                if(o !== _secureOtp.code) { document.getElementById('regOtp').parentElement.classList.add('shake'); return showToast('error', 'Sai OTP', 'Mã xác thực không đúng!'); }                const btn = this; btn.innerText = "Đang tạo..."; btn.disabled = true;                const snap = await firebase.database().ref('users/'+u).get();                if(snap.exists()){                    showToast('error', 'Trùng lặp', 'Tài khoản này đã tồn tại!');                    btn.innerText = "HOÀN TẤT ĐĂNG KÝ"; btn.disabled = false;                } else {                    const hashedPassword = await hashPass(p);                    firebase.database().ref('users/'+u).set({                        password: hashedPassword,                        name: n,                        email: e,                        created: new Date().toISOString()                    }, err => {                        if(!err) { showSuccessModal(u); }                    });                }            };            // --- LOGIN ---            document.getElementById('btnDoLogin').onclick = async function() {                const u = document.getElementById('logUser').value.trim();                const p = document.getElementById('logPass').value;                if(!u) { document.getElementById('logUser').parentElement.classList.add('shake'); return showToast('error', 'Thiếu User', 'Nhập tài khoản!'); }                if(!p) { document.getElementById('logPass').parentElement.classList.add('shake'); return showToast('error', 'Thiếu Pass', 'Nhập mật khẩu!'); }                const btn = this; btn.innerText = "Kiểm tra..."; btn.disabled = true;                try {                    const snap = await firebase.database().ref('users/'+u).get();                    if(snap.exists()) {                        const dbPass = snap.val().password;                        const inputHash = await hashPass(p);                                                if(dbPass === inputHash) { showSuccessModal(u); }                         else {                            showToast('error', 'Sai mật khẩu', 'Vui lòng kiểm tra lại!');                            btn.innerText = "ĐĂNG NHẬP"; btn.disabled = false;                            document.getElementById('logPass').value = "";                        }                    } else {                        showToast('error', 'Không tồn tại', 'Tài khoản này chưa đăng ký!');                        btn.innerText = "ĐĂNG NHẬP"; btn.disabled = false;                    }                } catch {                    showToast('error', 'Lỗi Server', 'Không thể kết nối Database!');                    btn.innerText = "ĐĂNG NHẬP"; btn.disabled = false;                }            };            // --- FORGOT ---            document.getElementById('btnDoForgot').onclick = async function() {                const u = document.getElementById('forUser').value.trim();                const e = document.getElementById('forEmail').value.trim();                const o = document.getElementById('forOtp').value;                const np = document.getElementById('forNewPass').value;                if(!u || !e) return showToast('error', 'Thiếu tin', 'Nhập User và Email trước!');                if(o !== _secureOtp.code) return showToast('error', 'Sai OTP', 'Mã xác thực không đúng!');                if(!np) { document.getElementById('boxNewPass').classList.remove('hidden'); return showToast('success', 'Xác thực OK', 'Vui lòng nhập mật khẩu mới!'); }                const newHash = await hashPass(np);                firebase.database().ref('users/'+u).update({ password: newHash }, err => {                    if(!err) {                        showToast('success', 'Thành công', 'Đổi mật khẩu thành công!');                        setTimeout(()=>switchView('viewLogin'), 2000);                    }                });            };            document.querySelectorAll('input').forEach(i => {                i.addEventListener('input', function() { this.parentElement.classList.remove('shake'); });            });        })();    </script></body></html>